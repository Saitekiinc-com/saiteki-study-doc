# Lv.2 応用: API開発・動作保証

Lv.2のゴールは、**「要件を満たすAPIを実装し、正常に動作することを確認できること」**です。
フレームワークを使用して、CRUD操作を行うAPIを構築します。

## 1. APIの実装
実際に動くサーバーを作ります。

### 学習項目
*   **ルーティングとコントローラー**:
    *   URLと処理の紐付け。
    *   リクエストパラメータ (`query`, `params`, `body`) の取得。
*   **バリデーション**:
    *   入力値のチェック（必須、型、文字数、形式）。
    *   不正なデータがDBに入らないようにする防御。
*   **サービス層の分離**:
    *   コントローラー（HTTPの処理）とサービス（ビジネスロジック）の分離。

### チェックリスト
- [ ] ユーザー登録APIで、メールアドレスの形式チェックを実装できる。
- [ ] IDを指定してユーザー情報を取得するAPIを実装できる。
- [ ] ビジネスロジックをコントローラーに直書きせず、関数やクラスに切り出せる。

## 2. データベース操作
アプリケーションからDBを操作します。

### 学習項目
*   **ORM / Query Builder**:
    *   Prisma, TypeORM, GORM などのツールの利用。
    *   マイグレーション管理（DBスキーマのバージョン管理）。
*   **CRUD操作**:
    *   Create, Read, Update, Delete の実装。

### チェックリスト
- [ ] マイグレーションファイルを作成し、DBにテーブルを作成できる。
- [ ] ORMを使って、関連するテーブル（例：ユーザーと投稿）を結合してデータを取得できる。

## 3. エラーハンドリングとログ
運用のしやすさを考慮します。

### 学習項目
*   **例外処理**:
    *   `try-catch` によるエラー捕捉。
    *   予期せぬエラーでサーバーを落とさない。
*   **構造化ロギング**:
    *   エラー時にスタックトレース、リクエストID、タイムスタンプを記録する。
    *   `console.log` ではなくロガーライブラリを使用する。

### チェックリスト
- [ ] DB接続エラーが発生した際に、クライアントに 500 エラーを返し、サーバー側にはログを残せる。
- [ ] 存在しないリソースへのアクセスに対して 404 エラーを返せる。
